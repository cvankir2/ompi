this is a lot of fixes in this one
